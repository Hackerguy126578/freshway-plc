<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Freshway PLC Staff Dashboard</title>
<style>
  /* Reset & base */
  body, html {
    margin: 0; padding: 0;
    height: 100%;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1E3A8A, #3B82F6);
    color: white;
  }
  .container {
    max-width: 1000px;
    margin: 40px auto;
    padding: 20px;
    background: rgba(255 255 255 / 0.12);
    border-radius: 16px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.4);
    display: flex;
    flex-direction: row;
    gap: 40px;
  }
  /* Sidebar with profile */
  .sidebar {
    width: 280px;
    background: rgba(255 255 255 / 0.18);
    border-radius: 16px;
    padding: 25px 20px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
  }
  .avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 3px solid #3B82F6;
    object-fit: cover;
    box-shadow: 0 0 10px rgba(59,130,246,0.6);
  }
  .username {
    font-size: 1.4rem;
    font-weight: 700;
    letter-spacing: 1px;
    margin-top: 10px;
  }
  .role {
    font-size: 1rem;
    font-weight: 600;
    background: #2563EB;
    padding: 6px 14px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(37, 99, 235, 0.5);
    margin-bottom: 20px;
  }
  .logout-btn {
    margin-top: auto;
    background-color: #EF4444;
    border: none;
    padding: 12px 30px;
    font-weight: 700;
    border-radius: 12px;
    cursor: pointer;
    color: white;
    box-shadow: 0 6px 15px rgb(239 68 68 / 0.6);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  .logout-btn:hover {
    background-color: #B91C1C;
    box-shadow: 0 8px 22px rgb(185 28 28 / 0.8);
  }

  /* Main content */
  .main-content {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 30px;
  }

  .actions {
    display: grid;
    grid-template-columns: repeat(auto-fit,minmax(180px,1fr));
    gap: 25px;
  }
  .action-btn {
    background-color: #2563EB;
    border: none;
    border-radius: 16px;
    padding: 20px;
    font-size: 1.1rem;
    font-weight: 700;
    color: white;
    cursor: pointer;
    box-shadow: 0 8px 25px rgb(37 99 235 / 0.6);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .action-btn:hover {
    background-color: #1D4ED8;
    box-shadow: 0 12px 32px rgb(29 78 216 / 0.85);
  }

  /* Rank check section */
  .rank-check {
    background: rgba(255 255 255 / 0.2);
    border-radius: 16px;
    padding: 25px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.3);
  }
  .rank-check h2 {
    margin-top: 0;
    margin-bottom: 15px;
    font-weight: 700;
  }
  .rank-check input[type="text"] {
    padding: 12px;
    border-radius: 12px;
    border: none;
    width: 260px;
    font-size: 1rem;
    margin-right: 12px;
  }
  .rank-check button {
    background-color: #2563EB;
    border: none;
    border-radius: 12px;
    padding: 12px 24px;
    font-size: 1rem;
    font-weight: 700;
    color: white;
    cursor: pointer;
    box-shadow: 0 6px 18px rgb(37 99 235 / 0.5);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  .rank-check button:hover {
    background-color: #1D4ED8;
    box-shadow: 0 8px 22px rgb(29 78 216 / 0.8);
  }
  #rankResult {
    margin-top: 18px;
    font-weight: 600;
  }
</style>
<script>
  // Redirect to main page if NOT logged in
  if (localStorage.getItem('staffLoggedIn') !== 'true') {
    window.location.href = '/index.html';
  }

  function logout() {
    localStorage.removeItem('staffLoggedIn');
    window.location.href = '/index.html';
  }

  const groupId = 13882588; // your Roblox group ID Freshway PLC

  async function checkRank() {
    const username = document.getElementById("username").value.trim();
    const rankResult = document.getElementById("rankResult");
    rankResult.textContent = "Checking...";
    if (!username) {
      rankResult.textContent = "Please enter a username.";
      return;
    }

    try {
      const userRes = await fetch(`https://api.roblox.com/users/get-by-username?username=${username}`);
      const userData = await userRes.json();

      if (userData.errorMessage) {
        rankResult.textContent = "User not found.";
        return;
      }

      const userId = userData.Id;
      const rankRes = await fetch(`https://groups.roblox.com/v1/users/${userId}/groups/roles`);
      const rankData = await rankRes.json();

      const groupInfo = rankData.data.find(g => g.group.id === groupId);
      if (!groupInfo) {
        rankResult.textContent = `${username} is NOT in the Freshway PLC group.`;
        return;
      }

      const roleName = groupInfo.role.name;
      const rankNumber = groupInfo.role.rank;

      rankResult.textContent = `${username} is in Freshway PLC as "${roleName}" (Rank: ${rankNumber})`;
    } catch (error) {
      rankResult.textContent = "Error checking rank. Try again later.";
      console.error(error);
    }
  }
</script>
</head>
<body>
  <div class="container">

    <aside class="sidebar">
      <img class="avatar" src="https://www.roblox.com/headshot-thumbnail/image?userId=12345678&width=420&height=420&format=png" alt="Profile Avatar" id="profileAvatar" />
      <div class="username" id="profileUsername">desjay123456</div>
      <div class="role" id="profileRole">Founder</div>
      <button class="logout-btn" onclick="logout()">Logout</button>
    </aside>

    <main class="main-content">
      <div class="actions">
        <button class="action-btn" onclick="alert('Shift Planning coming soon!')">Shift Planning</button>
        <button class="action-btn" onclick="alert('Send LOA feature coming soon!')">Send LOA</button>
        <button class="action-btn" onclick="alert('Admin Dashboard coming soon!')">Admin Dashboard</button>
        <button class="action-btn" onclick="alert('View Profiles coming soon!')">View Profiles</button>
      </div>

      <section class="rank-check">
        <h2>Check Roblox Group Rank</h2>
        <input type="text" id="username" placeholder="Enter Roblox username" />
        <button onclick="checkRank()">Check Rank</button>
        <div id="rankResult"></div>
      </section>
    </main>

  </div>
  <script>
    // Update the avatar image dynamically by Roblox username
    const username = "desjay123456";  // replace with dynamic data if available

    async function updateProfile() {
      try {
        // Get user ID from username
        const res = await fetch(`https://api.roblox.com/users/get-by-username?username=${username}`);
        const data = await res.json();
        if (data && data.Id) {
          document.getElementById("profileAvatar").src = `https://www.roblox.com/headshot-thumbnail/image?userId=${data.Id}&width=420&height=420&format=png`;
          document.getElementById("profileUsername").textContent = username;
          // Role is static here, or you could fetch group role info if you want dynamic roles
          document.getElementById("profileRole").textContent = "Founder";
        }
      } catch(e) {
        console.error("Failed to load profile avatar", e);
      }
    }
    updateProfile();
  </script>
</body>
</html>
